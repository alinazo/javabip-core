<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camel-osgi="http://camel.apache.org/schema/osgi"
	xmlns:osgix="http://www.springframework.org/schema/osgi-compendium"
	xmlns:ctx="http://www.springframework.org/schema/context" xmlns:osgi="http://www.springframework.org/schema/osgi"
	xsi:schemaLocation="
       http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd
       http://camel.apache.org/schema/osgi http://camel.apache.org/schema/osgi/camel-osgi.xsd
       http://www.springframework.org/schema/osgi-compendium http://www.springframework.org/schema/osgi-compendium/spring-osgi-compendium.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">
	
	<osgi:reference cardinality="1..1" id="actorSystem" interface="akka.actor.ActorSystem"/>

	<bean id="engineFactory" class="org.bip.engine.api.EngineFactory">
		<constructor-arg index="0" ref="actorSystem"/>
	</bean>
	
	<bean id="bipCoordinator" class="org.bip.engine.BIPCoordinatorImpl"/>
	<bean id="dataCoordinator" class="org.bip.engine.DataCoordinatorKernel">
		<constructor-arg index="0" ref="bipCoordinator"/>
	</bean>
		
	<bean id="bipEngine" factory-bean="engineFactory" factory-method="create" init-method="start" destroy-method="stop">
        <constructor-arg index="0" value="myEngineId"/>
        <constructor-arg index="1" ref="dataCoordinator"/>        
    </bean>

	<osgi:service ref="bipEngine" interface="org.bip.api.BIPEngine"/>
		
</beans>
